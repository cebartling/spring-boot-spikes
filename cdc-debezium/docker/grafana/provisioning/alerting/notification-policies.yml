apiVersion: 1

# Notification policies for CDC alerting
# In development, all alerts go to the default-webhook receiver.
# For production, uncomment and configure Slack/PagerDuty/Email routes.

policies:
  - orgId: 1
    receiver: default-webhook
    group_by:
      - grafana_folder
      - alertname
    group_wait: 30s
    group_interval: 5m
    repeat_interval: 4h
    routes:
      # Critical alerts - immediate notification
      - receiver: default-webhook
        matchers:
          - severity = critical
        group_wait: 0s
        group_interval: 1m
        repeat_interval: 1h

      # Warning alerts - 5 minute delay
      - receiver: default-webhook
        matchers:
          - severity = warning
        group_wait: 5m
        group_interval: 10m
        repeat_interval: 4h

      # Info alerts - batched
      - receiver: default-webhook
        matchers:
          - severity = info
        group_wait: 30m
        group_interval: 1h
        repeat_interval: 24h

# Production configuration example (uncomment when credentials are available):
# policies:
#   - orgId: 1
#     receiver: slack-platform
#     group_by:
#       - grafana_folder
#       - alertname
#     group_wait: 30s
#     group_interval: 5m
#     repeat_interval: 4h
#     routes:
#       # Critical alerts go to PagerDuty immediately
#       - receiver: pagerduty-critical
#         matchers:
#           - severity = critical
#         group_wait: 0s
#         group_interval: 1m
#         repeat_interval: 1h
#         continue: true  # Also send to Slack
#
#       # Critical also to Slack
#       - receiver: slack-platform
#         matchers:
#           - severity = critical
#         group_wait: 0s
#         group_interval: 1m
#         repeat_interval: 1h
#
#       # Warnings to Slack with 5min delay
#       - receiver: slack-platform
#         matchers:
#           - severity = warning
#         group_wait: 5m
#         group_interval: 10m
#         repeat_interval: 4h
#
#       # Info alerts batched to email
#       - receiver: email-digest
#         matchers:
#           - severity = info
#         group_wait: 30m
#         group_interval: 1h
#         repeat_interval: 24h
