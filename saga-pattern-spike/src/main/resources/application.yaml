server:
  error:
    include-stacktrace: never
    include-message: always

spring:
  application:
    name: sagapattern
  config:
    import: optional:vault://
  cloud:
    vault:
      enabled: true
      host: localhost
      port: 8200
      scheme: http
      authentication: TOKEN
      token: dev-root-token
      kv:
        enabled: true
        backend: secret
        default-context: sagapattern
        profile-separator: /
      database:
        enabled: true
        role: sagapattern-readwrite
        backend: database
        username-property: spring.r2dbc.username
        password-property: spring.r2dbc.password
  r2dbc:
    url: r2dbc:postgresql://localhost:5432/saga_db
    # username and password are injected by Vault's database secrets engine
    # For local development without Vault, these can be overridden via environment variables

saga:
  services:
    inventory:
      base-url: http://localhost:8081/api/inventory
    payment:
      base-url: http://localhost:8081/api/payments
    shipping:
      base-url: http://localhost:8081/api/shipments

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  health:
    vault:
      enabled: true
  endpoint:
    health:
      show-details: when_authorized
  # OpenTelemetry Configuration (Spring Boot 4.0 native support)
  tracing:
    enabled: true
    sampling:
      probability: 1.0
  otlp:
    tracing:
      endpoint: ${OTEL_EXPORTER_OTLP_ENDPOINT:http://localhost:4318}/v1/traces
    metrics:
      export:
        enabled: true
        step: 10s
        endpoint: ${OTEL_EXPORTER_OTLP_ENDPOINT:http://localhost:4318}/v1/metrics
    logging:
      export:
        enabled: true
        endpoint: ${OTEL_EXPORTER_OTLP_ENDPOINT:http://localhost:4318}/v1/logs

# OpenTelemetry SDK configuration
otel:
  service:
    name: sagapattern
  resource:
    attributes:
      deployment.environment: ${DEPLOYMENT_ENV:development}
      service.namespace: saga-spike
      service.version: ${APP_VERSION:0.0.1-SNAPSHOT}
