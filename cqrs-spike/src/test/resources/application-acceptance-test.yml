# Application configuration for acceptance tests
# Database properties are injected dynamically by Testcontainers

spring:
  application:
    name: cqrs-spike-acceptance-test

  # R2DBC configuration (values injected by Testcontainers)
  r2dbc:
    pool:
      enabled: true
      initial-size: 2
      max-size: 10

  # Flyway configuration for schema migrations
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    clean-disabled: false

  # Disable Vault for acceptance tests
  cloud:
    vault:
      enabled: false

# Logging configuration for acceptance tests
logging:
  level:
    root: WARN
    com.pintailconsultingllc.cqrsspike: INFO
    org.springframework.r2dbc: DEBUG
    io.cucumber: INFO

# Resilience4j configuration for acceptance tests
resilience4j:
  circuitbreaker:
    instances:
      productService:
        sliding-window-size: 5
        failure-rate-threshold: 50
        wait-duration-in-open-state: 1s
  retry:
    instances:
      productService:
        max-attempts: 2
        wait-duration: 100ms
  ratelimiter:
    instances:
      productService:
        limit-for-period: 100
        limit-refresh-period: 1s
